---
import { Icon } from 'astro-icon/components'


interface SubMenuItem {
  title: string;
  url: string;
}

interface MenuItems {
    title: string;
    url?: string;
    children?: SubMenuItem[];
}

const menuItems: MenuItems[] = [
  { title: 'Inicio', url: '/' },

  {
    title: 'Actividad',
    children: [
      {
        title: 'Transporte internacional',
        url: '/actividad/transporte-internacional',
      },
      {
        title: 'Consolidación de carga',
        url: '/actividad/consolidacion-de-carga',
      },
      {
        title: 'Asesoramiento y servicio de exportación',
        url: '/actividad/asesoramiento-exportacion',
      },
      {
        title: 'Agenciamiento de aduanas',
        url: '/actividad/agenciamiento-aduanas',
      },
    ],
  },

  { title: 'Socios Estratégicos', url: '/socios-estrategicos' },
  { title: 'Sobre Nosotros', url: '/sobre-nosotros' },
  { title: 'Contáctanos', url: '/contacto' },
];

---

<header  id="header" class="fixed inset-x-0 top-0 z-50 p-3 lg:hidden transition-all duration-300 ease-out
         bg-transparent">
    <nav class="flex justify-between items-center">
        <a href="/" >

            <img id="logo" src="/logo-aurummetals-color.webp" alt="Logo kener dev" class="size-10 block"/>
            
        </a>  

        <Icon id="btnAbrirMenu" name="ci:menu-alt-05" 
        class="text-nav size-12 flex z-50"/>

    </nav>

    <div
    id="Menu"
    class="fixed inset-0 z-40 p-3
        bg-nav backdrop-blur-md
        origin-top scale-y-0 transition-transform duration-300 ease-out"
    >
        <div id="Menu" class="fixed inset-0 z-40 bg-red backdrop-blur-md mt-2">
            <div class="flex flex-row  justify-between items-center  p-3">
                    <a href="/" aria-label="Visitar sitio web de Aurum Logistics" >
                        <img id="logo" src="/logo-aurummetals-color.webp" alt="Logo kener dev" class="size-10 block"/>
                    </a> 

                    <Icon id="btnCerrarMenu" name="iconamoon:close-thin"
                            class="text-negro size-12 hidden z-50" />
            </div>



            <div class="w-full flex flex-col items-center">
                

            <div class="flex flex-col items-center justify-center mt-5 w-full h-full">
                <ul class="flex flex-col gap-5 w-full">
  {menuItems.map((item, index) => (
    <li class="w-full text-center">
      
      {/* ITEM NORMAL */}
      {!item.children && (
        <a
          href={item.url}
          class="block text-xl font-bold py-2"
        >
          {item.title}
        </a>
      )}

      {/* ITEM CON SUBMENU */}
      {item.children && (
        <>
          <button
            type="button"
            class="w-full flex items-center justify-center gap-2
                   text-xl font-bold py-2"
            data-submenu-button
          >
            {item.title}
            <Icon name="mdi:chevron-down" class="size-6 transition-transform duration-300" />
          </button>

          <ul
            class="mt-2 flex flex-col gap-3
                   max-h-0 overflow-hidden
                   transition-all duration-300 ease-out"
            data-submenu
          >
            {item.children.map((sub) => (
              <li>
                <a
                  href={sub.url}
                  class="block text-base font-medium py-1 opacity-90"
                >
                  {sub.title}
                </a>
              </li>
            ))}
          </ul>
        </>
      )}
    </li>
  ))}
</ul>


                

            </div>

           
           
        </div>

    </div>
    
</header>


<script>

    const btnAbrirMenu = document.getElementById("btnAbrirMenu") ;
    const btnCerrarMenu = document.getElementById("btnCerrarMenu") ;
    const Menu = document.getElementById("Menu");
    const Logo = document.getElementById("logo");
    const LogoNegro = document.getElementById("logoNegro");
    const header = document.getElementById("header");
    let lastScrollY = window.scrollY;
    

   if(btnAbrirMenu && btnCerrarMenu && Menu && header){


        btnAbrirMenu.addEventListener("click", (e)=>{
        e.preventDefault()
            
           
            btnAbrirMenu.classList.replace("flex", "hidden")
            btnCerrarMenu.classList.replace("hidden","block")
            btnCerrarMenu.classList.remove("text-nav")
            btnCerrarMenu.classList.add("text-black")
            Menu.classList.remove("scale-y-0");
            Menu.classList.add("scale-y-100");

         
            


            document.body.classList.add("overflow-hidden");
    })

        btnCerrarMenu.addEventListener("click", (e)=>{
        e.preventDefault()
            document.body.classList.remove("overflow-hidden");
            btnAbrirMenu.classList.replace("hidden", "flex")
            btnCerrarMenu.classList.replace("block","hidden")
            Menu.classList.remove("scale-y-100");
            Menu.classList.add("scale-y-0");

    
    })

    window.addEventListener("scroll", () => {
    const currentScroll = window.scrollY;

    if (currentScroll > 20) {
      // Scroll hacia abajo → mostrar fondo
      header.classList.add("bg-hero", "backdrop-blur-md", "shadow-sm");
      header.classList.remove("bg-transparent");
    } else {
      // De vuelta al top → ocultar fondo
      header.classList.remove("bg-hero", "backdrop-blur-md", "shadow-sm");
      header.classList.add("bg-transparent");
    }

    lastScrollY = currentScroll;
  });

   }

    
</script>

<script>
  const submenuButtons = document.querySelectorAll("[data-submenu-button]");

  submenuButtons.forEach((btn) => {
    btn.addEventListener("click", () => {
      const submenu = btn.nextElementSibling;
      const icon = btn.querySelector("svg");

      if (!submenu) return;

      const isOpen = submenu.style.maxHeight;

      // Cerrar todos
      document.querySelectorAll("[data-submenu]").forEach((menu) => {
        menu.style.maxHeight = null;
      });
      document.querySelectorAll("[data-submenu-button] svg").forEach((i) => {
        i.classList.remove("rotate-180");
      });

      // Abrir el actual
      if (!isOpen) {
        submenu.style.maxHeight = submenu.scrollHeight + "px";
        icon?.classList.add("rotate-180");
      }
    });
  });
</script>
